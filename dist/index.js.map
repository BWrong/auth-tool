{"version":3,"sources":["webpack://authTool/webpack/universalModuleDefinition","webpack://authTool/./src/directive.js","webpack://authTool/./src/ganerAuthData.js","webpack://authTool/./src/util.js","webpack://authTool/./src/index.js","webpack://authTool/webpack/bootstrap","webpack://authTool/webpack/startup","webpack://authTool/webpack/runtime/define property getters","webpack://authTool/webpack/runtime/hasOwnProperty shorthand","webpack://authTool/webpack/runtime/make namespace object"],"names":["root","factory","exports","module","define","amd","self","authDirective","install","Vue","directiveName","hasAuth","directive","inserted","el","binding","value","parentNode","removeChild","routeMap","_getAuthRoutes","routes","authMap","filter","route","newRoute","_checkAuth","meta","permission","auth","children","convertToTree","data","pid","pidName","idName","arr","map","item","child","concat","push","getParentsFromArray","id","result","unshift","getParentsFromPermission","split","reduce","temp","length","util","utils","ganerAuthData","permissions","authKey","_ganAuthMap","menus","url","path","_addPathOfMenus","authDirectiveSrc","__webpack_module_cache__","__webpack_require__","moduleId","__webpack_modules__","d","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag"],"mappings":"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","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"authTool\"] = factory();\n\telse\n\t\troot[\"authTool\"] = factory();\n})(self, function() {\nreturn ","/**\n * 注册权限指令\n * @param {*} directiveName  指令名字\n * @param {*} hasAuth  检查函数\n */\nexport const authDirective = {\n  install(Vue, { directiveName = 'auth', hasAuth = () => true } = {}) {\n    Vue.directive(directiveName, {\n      inserted(el, binding) {\n        !hasAuth(binding.value) && el.parentNode?.removeChild(el);\n      }\n    });\n  }\n};\n","/*\r\n * @Author: Bwrong\r\n * @Github: https://github.com/BWrong\r\n * @Date: 2020-07-03 15:57:14\r\n * @LastEditors: Bwrong\r\n * @LastEditTime: 2020-12-16 08:55:47\r\n */\r\nlet routeMap = {}; // 路由映射表\r\n\r\nexport default ({ routes = [], permissions = [], authKey = 'permission' }) => {\r\n  // 权限映射表\r\n  const authMap = _ganAuthMap(permissions, authKey);\r\n  // 清洗后，有权限额路由，用于动态注册路由\r\n  const authRoutes = _getAuthRoutes(routes, authMap);\r\n  // 添加了path/url的菜单，用于渲染导航\r\n  const menusWithPath = _addPathOfMenus(routeMap, permissions, authKey);\r\n  return {\r\n    authMap,\r\n    routes: authRoutes,\r\n    menus: menusWithPath\r\n  };\r\n};\r\n\r\n/**\r\n * 创建权限映射表\r\n * @param {*} permissions  权限映射表\r\n * @param {*} authKey  权限集权限标识key名\r\n */\r\nfunction _ganAuthMap(permissions, authKey) {\r\n  return permissions.reduce((temp, item) => ((temp[item[authKey]] = item), temp), {});\r\n}\r\n/**\r\n * 清洗路由，获取具有权限的路由\r\n * @param {*} routes 前端路由映射表\r\n * @param {*} authMap 权限标识表，map\r\n */\r\nfunction _getAuthRoutes(routes = [], authMap = {}) {\r\n  return routes.filter((route) => {\r\n    let newRoute = { ...route };\r\n    if (_checkAuth(newRoute, authMap)) {\r\n      if (route.meta?.permission) {\r\n        // 将路由存入routeMap\r\n        routeMap[route.meta.permission] = route;\r\n        route.meta.auth = authMap[route.meta.permission];\r\n      }\r\n      newRoute.children && (newRoute.children = _getAuthRoutes(newRoute.children, authMap));\r\n      return true;\r\n    }\r\n    return false;\r\n  });\r\n}\r\n/**\r\n * 清洗方法，权限标识不存在或者存在且匹配返回true\r\n * @param {*} route 路由对象\r\n * @param {*} authMap 权限标识表，map\r\n */\r\nfunction _checkAuth(route, authMap) {\r\n  return route.meta?.permission ? !!authMap[route.meta.permission] : true;\r\n}\r\n/**\r\n * 为菜单添加path\r\n * TODO: 增加对相对路径的支持\r\n * @param {*} routesMap  路由映射map\r\n * @param {*} menus  菜单数据\r\n * @param {*} authKey 权限集权限标识key名\r\n */\r\nfunction _addPathOfMenus(routeMap = {}, menus = [], authKey) {\r\n  return menus.map((item) => {\r\n    item.url = (item[authKey] && routeMap[item[authKey]]?.path) || '';\r\n    if (item.children?.length) {\r\n      item.children = this._addPathOfMenus(routeMap, menus, authKey);\r\n    }\r\n    return item;\r\n  });\r\n}\r\n","/********** 工具函数 ************/\n/**\n * 将一维数组格式转换成树结构\n * TODO: 考虑使用尾递归优化算法\n * @param {*} data  需要转换的数据\n * @param {*} pid   顶级节点的id\n * @param {*} children   子集标识key\n * @param {*} pidName    父级标识key\n * @param {*} idName     id标识key\n */\nexport function convertToTree({ data = [], pid = 0, children = 'children', pidName = 'parentId', idName = 'id' }) {\n  let arr = [];\n  data.map((item) => {\n    if (item[pidName] === pid) {\n      let child = item[children] || [];\n      item[children] = child.concat(convertToTree({ data, pid: item[idName], children, pidName, idName }));\n      arr.push(item);\n    }\n  });\n  return arr;\n}\n/**\n * 从数组中根据id获取所有父级元素，返回数组\n * TODO: 考虑使用尾递归优化算法\n * @param id  // 当前项的id\n * @param data  // 要查找的数组\n * @param {*} idName     id标识key\n * @param {*} pidName    父级标识key\n * @param result // 返回结果\n */\nexport function getParentsFromArray({id, data, idName = 'id', pidName = 'parentId', result = []}) {\n  for (const item of data) {\n    if (item[idName] === id) {\n      result.unshift(item);\n      getParentsFromArray({ id:item[pidName], data, idName, pidName, result });\n    }\n  }\n  return result;\n}\n/**\n * 从permission获取所有父级permission,注意，此方式要求permission命名遵循层级关系\n * @param permission\n */\nexport function getParentsFromPermission(permission) {\n  return permission.split('/').reduce((temp, item) => {\n    temp.push((temp[temp.length - 1] || '') + (item ? '/' : '') + item);\n    return temp;\n  }, []);\n}\n","/*\n * @Author: Bwrong\n * @Github: https://github.com/BWrong\n * @Date: 2020-12-10 11:04:57\n * @LastEditors: Bwrong\n * @LastEditTime: 2020-12-13 22:01:04\n */\nimport { authDirective as authDirectiveSrc } from './directive';\nimport ganerAuthDataSrc from './ganerAuthData';\nimport * as utils from './util';\n\nexport const util = utils;\nexport const ganerAuthData = ganerAuthDataSrc;\nexport const authDirective = authDirectiveSrc;\nexport default {\n  ganerAuthData,\n  authDirective,\n  util\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// module exports must be returned from runtime so entry inlining is disabled\n// startup\n// Load entry module and return exports\nreturn __webpack_require__(153);\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};"],"sourceRoot":""}