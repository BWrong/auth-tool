{"version":3,"sources":["webpack://authTool/webpack/universalModuleDefinition","webpack://authTool/./src/directive.js","webpack://authTool/./src/ganerAuthData.js","webpack://authTool/./src/util.js","webpack://authTool/./src/index.js","webpack://authTool/webpack/bootstrap","webpack://authTool/webpack/startup","webpack://authTool/webpack/runtime/define property getters","webpack://authTool/webpack/runtime/hasOwnProperty shorthand","webpack://authTool/webpack/runtime/make namespace object"],"names":["root","factory","exports","module","define","amd","self","authDirective","install","Vue","directiveName","hasAuth","directive","inserted","el","binding","value","parentNode","removeChild","routeMap","defaultAuthKey","_getAuthRoutes","routes","authMap","checkAuth","_checkAuth","mergeMeta","_mergeMeta","filter","route","meta","permission","children","_addPathOfMenus","menus","authKey","map","item","url","path","length","routeMeta","authMeta","Object","assign","_checkParamIsArray","param","key","Array","isArray","console","error","convertToTree","data","pid","pidName","idName","arr","child","concat","push","getParentsFromArray","id","result","unshift","util","utils","ganerAuthData","permissions","reduce","temp","_ganAuthMap","authDirectiveSrc","__webpack_module_cache__","__webpack_require__","moduleId","__webpack_modules__","d","definition","o","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag"],"mappings":"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","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"authTool\"] = factory();\n\telse\n\t\troot[\"authTool\"] = factory();\n})(self, function() {\nreturn ","/**\n * 注册权限指令\n * @param {*} directiveName  指令名字\n * @param {*} hasAuth  检查函数\n */\nexport const authDirective = {\n  install(Vue, { directiveName = 'auth', hasAuth = () => true } = {}) {\n    Vue.directive(directiveName, {\n      inserted(el, binding) {\n        !hasAuth(binding.value) && el.parentNode?.removeChild(el);\n      }\n    });\n  }\n};\n","\r\n/*\r\n * @Author: Bwrong\r\n * @Github: https://github.com/BWrong\r\n * @Date: 2020-07-03 15:57:14\r\n * @LastEditors: Bwrong\r\n * @LastEditTime: 2020-12-19 23:02:23\r\n */\r\nlet routeMap = {}; // 路由映射表\r\nconst defaultAuthKey = 'permission';\r\nexport default ({ routes = [], permissions = [], authKey = defaultAuthKey, checkAuth = _checkAuth, mergeMeta = _mergeMeta }) => {\r\n  // 校验参数\r\n  _checkParamIsArray(routes, 'routes');\r\n  _checkParamIsArray(permissions, 'permissions');\r\n  // 权限映射表\r\n  const authMap = _ganAuthMap(permissions, authKey);\r\n  // 清洗后，有权限额路由，用于动态注册路由\r\n  const authRoutes = _getAuthRoutes(routes, authMap, checkAuth, mergeMeta);\r\n  // 添加了path/url的菜单，用于渲染导航\r\n  const menusWithPath = _addPathOfMenus(routeMap, permissions, authKey);\r\n  return {\r\n    authMap,\r\n    routes: authRoutes,\r\n    menus: menusWithPath\r\n  };\r\n};\r\n/**\r\n * 创建权限映射表\r\n * @param {*} permissions  权限映射表\r\n * @param {*} authKey  权限集权限标识key名\r\n */\r\nfunction _ganAuthMap(permissions = [], authKey = defaultAuthKey) {\r\n  // TODO:支持嵌套结构\r\n  return permissions.reduce((temp, item) => ((temp[item[authKey]] = item), temp), {});\r\n}\r\n/**\r\n * 清洗路由，获取具有权限的路由\r\n * @param {*} routes 前端路由映射表\r\n * @param {*} authMap 权限标识表，map\r\n * @param {*} checkAuth 权限检查方法\r\n * @param {*} mergeMeta meta数据合并策略\r\n */\r\nfunction _getAuthRoutes(routes = [], authMap = {}, checkAuth = _checkAuth, mergeMeta = _mergeMeta) {\r\n  return routes.filter((route) => {\r\n    if (checkAuth(route, authMap)) {\r\n      if (route.meta?.permission) {\r\n        // 将路由存入routeMap, 方便_addPathOfMenus查找路由\r\n        routeMap[route.meta.permission] = route;\r\n        route.meta = mergeMeta(route.meta, authMap[route.meta.permission]);\r\n      }\r\n      route.children && (route.children = _getAuthRoutes(route.children, authMap));\r\n      return true;\r\n    }\r\n    return false;\r\n  });\r\n}\r\n/**\r\n * 为菜单添加path\r\n * TODO: 增加对相对路径的支持\r\n * @param {*} routesMap  路由映射map\r\n * @param {*} menus  菜单数据\r\n * @param {*} authKey 权限集权限标识key名\r\n */\r\nfunction _addPathOfMenus(routeMap = {}, menus = [], authKey=defaultAuthKey) {\r\n  return menus.map((item) => {\r\n    item.url = (item[authKey] && routeMap[item[authKey]]?.path) || '';\r\n    if (item.children?.length) {\r\n      item.children = _addPathOfMenus(routeMap, menus, authKey);\r\n    }\r\n    return item;\r\n  });\r\n}\r\n/**\r\n * 清洗方法，权限标识不存在或者存在且匹配，则返回true\r\n * @param {*} route 检测的路由对象\r\n * @param {*} authMap 权限标识表, object, key为的值（配置的authKey的值）\r\n */\r\nfunction _checkAuth(route, authMap) {\r\n  return route.meta?.permission ? !!authMap[route.meta.permission] : true;\r\n}\r\n/**\r\n * route.meta数据合并策略\r\n * @param {*} routeMeta 路由meta数据\r\n * @param {*} authMeta 路由对应权限菜单数据\r\n */\r\nfunction _mergeMeta(routeMeta, authMeta) {\r\n  return Object.assign(routeMeta, authMeta);\r\n}\r\n/**\r\n * 校验参数是否为数组\r\n * @param {*} param\r\n * @param {*} key\r\n */\r\nfunction _checkParamIsArray(param, key) {\r\n  return Array.isArray(param) || (console.error(`@bwrong/auth-tool/ganerAuthData: ${key}参数传入数据类型不正确，请传入Array数据类型`),false);\r\n}","/********** 工具函数 ************/\n/**\n * 将一维数组格式转换成树结构\n * TODO: 考虑使用尾递归优化算法。\n * @param {*} data  需要转换的数据\n * @param {*} pid   顶级节点的id\n * @param {*} children   子集标识key\n * @param {*} pidName    父级标识key\n * @param {*} idName     id标识key\n */\nexport function convertToTree({ data = [], pid = 0, children = 'children', pidName = 'parentId', idName = 'id' }) {\n  let arr = [];\n  data.map((item) => {\n    if (item[pidName] === pid) {\n      let child = item[children] || [];\n      item[children] = child.concat(convertToTree({ data, pid: item[idName], children, pidName, idName }));\n      arr.push(item);\n    }\n  });\n  return arr;\n}\n/**\n * 从数组中根据id获取所有父级元素，返回数组\n * TODO: 考虑使用尾递归优化算法\n * @param id  // 当前项的id\n * @param data  // 要查找的数组\n * @param {*} idName     id标识key\n * @param {*} pidName    父级标识key\n * @param result // 返回结果\n */\nexport function getParentsFromArray({id, data, idName = 'id', pidName = 'parentId', result = []}) {\n  for (const item of data) {\n    if (item[idName] === id) {\n      result.unshift(item);\n      getParentsFromArray({ id:item[pidName], data, idName, pidName, result });\n    }\n  }\n  return result;\n}\n","/*\n * @Author: Bwrong\n * @Github: https://github.com/BWrong\n * @Date: 2020-12-10 11:04:57\n * @LastEditors: Bwrong\n * @LastEditTime: 2020-12-13 22:01:04\n */\nimport { authDirective as authDirectiveSrc } from './directive';\nimport ganerAuthDataSrc from './ganerAuthData';\nimport * as utils from './util';\n\nexport const util = utils;\nexport const ganerAuthData = ganerAuthDataSrc;\nexport const authDirective = authDirectiveSrc;\nexport default {\n  ganerAuthData,\n  authDirective,\n  util\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// module exports must be returned from runtime so entry inlining is disabled\n// startup\n// Load entry module and return exports\nreturn __webpack_require__(153);\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};"],"sourceRoot":""}