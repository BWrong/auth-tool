{"version":3,"sources":["webpack://authTool/webpack/universalModuleDefinition","webpack://authTool/./src/directive.js","webpack://authTool/./src/ganerAuthData.js","webpack://authTool/./src/util.js","webpack://authTool/./src/index.js","webpack://authTool/webpack/bootstrap","webpack://authTool/webpack/startup","webpack://authTool/webpack/runtime/define property getters","webpack://authTool/webpack/runtime/hasOwnProperty shorthand","webpack://authTool/webpack/runtime/make namespace object"],"names":["root","factory","exports","module","define","amd","self","authDirective","install","Vue","directiveName","hasAuth","directive","inserted","el","binding","value","parentNode","removeChild","routeMap","_getAuthRoutes","routes","authMap","checkAuth","_checkAuth","mergeMeta","_mergeMeta","filter","route","newRoute","meta","permission","children","routeMeta","authMeta","convertToTree","data","pid","pidName","idName","arr","map","item","child","concat","push","getParentsFromArray","id","result","unshift","getParentsFromPermission","split","reduce","temp","length","util","utils","ganerAuthData","permissions","authKey","_ganAuthMap","menus","url","path","_addPathOfMenus","authDirectiveSrc","__webpack_module_cache__","__webpack_require__","moduleId","__webpack_modules__","d","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag"],"mappings":"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","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"authTool\"] = factory();\n\telse\n\t\troot[\"authTool\"] = factory();\n})(self, function() {\nreturn ","/**\n * 注册权限指令\n * @param {*} directiveName  指令名字\n * @param {*} hasAuth  检查函数\n */\nexport const authDirective = {\n  install(Vue, { directiveName = 'auth', hasAuth = () => true } = {}) {\n    Vue.directive(directiveName, {\n      inserted(el, binding) {\n        !hasAuth(binding.value) && el.parentNode?.removeChild(el);\n      }\n    });\n  }\n};\n","/*\r\n * @Author: Bwrong\r\n * @Github: https://github.com/BWrong\r\n * @Date: 2020-07-03 15:57:14\r\n * @LastEditors: Bwrong\r\n * @LastEditTime: 2020-12-17 10:11:34\r\n */\r\nlet routeMap = {}; // 路由映射表\r\nexport default ({ routes = [], permissions = [], authKey = 'permission', checkAuth = _checkAuth, mergeMeta = _mergeMeta }) => {\r\n  // 权限映射表\r\n  const authMap = _ganAuthMap(permissions, authKey);\r\n  // 清洗后，有权限额路由，用于动态注册路由\r\n  const authRoutes = _getAuthRoutes(routes, authMap, checkAuth, mergeMeta);\r\n  // 添加了path/url的菜单，用于渲染导航\r\n  const menusWithPath = _addPathOfMenus(routeMap, permissions, authKey);\r\n  return {\r\n    authMap,\r\n    routes: authRoutes,\r\n    menus: menusWithPath\r\n  };\r\n};\r\n/**\r\n * 创建权限映射表\r\n * @param {*} permissions  权限映射表\r\n * @param {*} authKey  权限集权限标识key名\r\n */\r\nfunction _ganAuthMap(permissions, authKey) {\r\n  return permissions.reduce((temp, item) => ((temp[item[authKey]] = item), temp), {});\r\n}\r\n/**\r\n * 清洗路由，获取具有权限的路由\r\n * @param {*} routes 前端路由映射表\r\n * @param {*} authMap 权限标识表，map\r\n * @param {*} checkAuth 权限检查方法\r\n * @param {*} mergeMeta meta数据合并策略\r\n */\r\nfunction _getAuthRoutes(routes = [], authMap = {}, checkAuth = _checkAuth, mergeMeta = _mergeMeta) {\r\n  return routes.filter((route) => {\r\n    let newRoute = { ...route };\r\n    if (checkAuth(newRoute, authMap)) {\r\n      if (route.meta?.permission) {\r\n        // 将路由存入routeMap\r\n        routeMap[route.meta.permission] = route;\r\n        route.meta = mergeMeta(route.meta, authMap[route.meta.permission])\r\n        // route.meta.auth = authMap[route.meta.permission];\r\n      }\r\n      newRoute.children && (newRoute.children = _getAuthRoutes(newRoute.children, authMap));\r\n      return true;\r\n    }\r\n    return false;\r\n  });\r\n}\r\n/**\r\n * 清洗方法，权限标识不存在或者存在且匹配，则返回true\r\n * @param {*} route 检测的路由对象\r\n * @param {*} authMap 权限标识表, object, key为的值（配置的authKey的值）\r\n */\r\nfunction _checkAuth(route, authMap) {\r\n  return route.meta?.permission ? !!authMap[route.meta.permission] : true;\r\n}\r\n/**\r\n * route.meta数据合并策略\r\n * @param {*} routeMeta 路由meta数据\r\n * @param {*} authMeta 路由对应权限菜单数据\r\n */\r\nfunction _mergeMeta(routeMeta, authMeta) {\r\n  return {\r\n    ...routeMeta,\r\n    ...authMeta\r\n  }\r\n}\r\n/**\r\n * 为菜单添加path\r\n * TODO: 增加对相对路径的支持\r\n * @param {*} routesMap  路由映射map\r\n * @param {*} menus  菜单数据\r\n * @param {*} authKey 权限集权限标识key名\r\n */\r\nfunction _addPathOfMenus(routeMap = {}, menus = [], authKey) {\r\n  return menus.map((item) => {\r\n    item.url = (item[authKey] && routeMap[item[authKey]]?.path) || '';\r\n    if (item.children?.length) {\r\n      item.children = this._addPathOfMenus(routeMap, menus, authKey);\r\n    }\r\n    return item;\r\n  });\r\n}\r\n","/********** 工具函数 ************/\n/**\n * 将一维数组格式转换成树结构\n * TODO: 考虑使用尾递归优化算法\n * @param {*} data  需要转换的数据\n * @param {*} pid   顶级节点的id\n * @param {*} children   子集标识key\n * @param {*} pidName    父级标识key\n * @param {*} idName     id标识key\n */\nexport function convertToTree({ data = [], pid = 0, children = 'children', pidName = 'parentId', idName = 'id' }) {\n  let arr = [];\n  data.map((item) => {\n    if (item[pidName] === pid) {\n      let child = item[children] || [];\n      item[children] = child.concat(convertToTree({ data, pid: item[idName], children, pidName, idName }));\n      arr.push(item);\n    }\n  });\n  return arr;\n}\n/**\n * 从数组中根据id获取所有父级元素，返回数组\n * TODO: 考虑使用尾递归优化算法\n * @param id  // 当前项的id\n * @param data  // 要查找的数组\n * @param {*} idName     id标识key\n * @param {*} pidName    父级标识key\n * @param result // 返回结果\n */\nexport function getParentsFromArray({id, data, idName = 'id', pidName = 'parentId', result = []}) {\n  for (const item of data) {\n    if (item[idName] === id) {\n      result.unshift(item);\n      getParentsFromArray({ id:item[pidName], data, idName, pidName, result });\n    }\n  }\n  return result;\n}\n/**\n * 从permission获取所有父级permission,注意，此方式要求permission命名遵循层级关系\n * @param permission\n */\nexport function getParentsFromPermission(permission) {\n  return permission.split('/').reduce((temp, item) => {\n    temp.push((temp[temp.length - 1] || '') + (item ? '/' : '') + item);\n    return temp;\n  }, []);\n}\n","/*\n * @Author: Bwrong\n * @Github: https://github.com/BWrong\n * @Date: 2020-12-10 11:04:57\n * @LastEditors: Bwrong\n * @LastEditTime: 2020-12-13 22:01:04\n */\nimport { authDirective as authDirectiveSrc } from './directive';\nimport ganerAuthDataSrc from './ganerAuthData';\nimport * as utils from './util';\n\nexport const util = utils;\nexport const ganerAuthData = ganerAuthDataSrc;\nexport const authDirective = authDirectiveSrc;\nexport default {\n  ganerAuthData,\n  authDirective,\n  util\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// module exports must be returned from runtime so entry inlining is disabled\n// startup\n// Load entry module and return exports\nreturn __webpack_require__(153);\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};"],"sourceRoot":""}